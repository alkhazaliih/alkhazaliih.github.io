<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex,nofollow">
  <title>لوحة التحكم | Sanad Khazalih</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../styles.css">
  <script src="https://kit.fontawesome.com/de7a860622.js" crossorigin="anonymous"></script>
  <link rel="icon" href="https://avatars.githubusercontent.com/u/99549578?v=4" type="image/x-icon">
  <style>
    .dashboard-page{padding-top:140px;min-height:100vh}
    .dashboard-grid{display:grid;grid-template-columns:1.4fr .6fr;gap:24px}
    .kpi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:24px}
    .kpi-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:20px;display:flex;flex-direction:column;gap:8px;transition:var(--transition)}
    .kpi-card:hover{border-color:var(--border-hover);transform:translateY(-3px)}
    .kpi-title{color:var(--text-secondary);font-size:.9rem}
    .kpi-value{font-size:1.6rem;font-weight:800}
    .kpi-trend{display:flex;align-items:center;gap:8px;color:var(--accent-light);font-size:.9rem}
    .panel{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:20px}
    .panel h3{font-size:1.1rem;margin-bottom:12px}
    .projects-list{display:flex;flex-direction:column;gap:14px}
    .project-item{display:flex;align-items:flex-start;gap:14px;padding:14px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--bg-secondary)}
    .project-meta{flex:1}
    .project-title{font-weight:700;margin-bottom:6px}
    .project-client{color:var(--text-secondary);font-size:.9rem;margin-bottom:10px}
    .progress{height:10px;background:rgba(255,255,255,.08);border-radius:100px;overflow:hidden}
    .progress > span{display:block;height:100%;background:var(--gradient-primary)}
    .progress-meta{display:flex;justify-content:space-between;font-size:.85rem;color:var(--text-secondary);margin-top:6px}
    .chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:100px;border:1px solid var(--border);color:var(--text-secondary);font-size:.85rem}
    .clients-table{width:100%;border-collapse:collapse}
    .clients-table th,.clients-table td{padding:12px 14px;border-bottom:1px solid var(--border);text-align:right}
    .clients-table th{color:var(--text-secondary);font-weight:600;background:rgba(255,255,255,.02)}
    .client-actions{display:flex;gap:10px}
    .btn-link{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid var(--border);border-radius:100px;color:var(--accent-light)}
    .btn-link:hover{border-color:var(--border-hover)}
    .side-grid{display:flex;flex-direction:column;gap:16px}
    .activity-list{display:flex;flex-direction:column;gap:12px}
    .activity-item{display:flex;gap:10px;align-items:center}
    .dot{width:10px;height:10px;border-radius:50%}
    .dot.success{background:#27ca40}
    .dot.warn{background:#ffbd2e}
    .dot.info{background:#5865F2}
    .due-list{display:flex;flex-direction:column;gap:12px}
    .due-item{display:flex;justify-content:space-between;align-items:center;padding:12px;border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--bg-secondary)}
    .chart-wrap{height:220px}
    canvas{width:100%;height:220px}
    @media (max-width:1000px){.dashboard-grid{grid-template-columns:1fr}.kpi-grid{grid-template-columns:repeat(2,1fr)}}
  </style>
</head>
<body>
  <script>
    if(localStorage.getItem("dashboardAuth")!=="1"){window.location.href="./login.html"}
  </script>
  <div class="particles" id="particles"></div>
  <nav class="nav">
    <div class="nav-container">
      <a href="../" class="nav-logo">Sanad Khazalih</a>
      <button class="nav-toggle" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <ul class="nav-links">
        <li><a href="../">Home</a></li>
        <li><a href="../#about">About</a></li>
        <li><a href="../#projects">Projects</a></li>
        <li><a href="../Download/">Downloads</a></li>
        <li><a href="#" class="active">Dashboard</a></li>
        <li><a href="../#skills">Skills</a></li>
        <li><a href="../#testimonials">Testimonials</a></li>
        <li><a href="../#contact">Contact</a></li>
      </ul>
    </div>
  </nav>
  <section class="dashboard-page">
    <div class="container">
      <div class="section-header">
        <span class="section-tag">Dashboard</span>
        <h2 class="section-title">لوحة تحكم المشاريع والعملاء</h2>
        <p class="section-desc">نظرة سريعة على الإيرادات، تقدّم المشاريع، والعملاء. البيانات هنا تجريبية ويمكن ربطها ببياناتك لاحقًا.</p>
        <div style="margin-top:12px">
          <button class="chip" id="logoutBtn"><i class="fa-solid fa-right-from-bracket"></i><span>تسجيل خروج</span></button>
          <button class="chip" id="addProjectBtn"><i class="fa-solid fa-plus"></i><span>إضافة مشروع</span></button>
          <button class="chip" id="addClientBtn"><i class="fa-solid fa-user-plus"></i><span>إضافة عميل</span></button>
          <button class="chip" id="updateKpiBtn"><i class="fa-solid fa-chart-line"></i><span>تحديث المؤشرات</span></button>
          <button class="chip" id="exportBtn"><i class="fa-solid fa-file-export"></i><span>تصدير JSON</span></button>
          <button class="chip" id="importBtn"><i class="fa-solid fa-file-import"></i><span>استيراد JSON</span></button>
        </div>
      </div>
      <div class="kpi-grid">
        <div class="kpi-card">
          <span class="kpi-title">الإيراد الشهري</span>
          <span class="kpi-value" id="kpi-month-revenue">—</span>
          <span class="kpi-trend" id="kpi-month-trend"><i class="fa-solid fa-arrow-trend-up"></i><span>—%</span></span>
        </div>
        <div class="kpi-card">
          <span class="kpi-title">إجمالي الإيرادات</span>
          <span class="kpi-value" id="kpi-total-revenue">—</span>
          <span class="kpi-trend"><i class="fa-solid fa-coins"></i><span>آخر 12 شهر</span></span>
        </div>
        <div class="kpi-card">
          <span class="kpi-title">عدد العملاء</span>
          <span class="kpi-value" id="kpi-clients">—</span>
          <span class="kpi-trend"><i class="fa-solid fa-user-group"></i><span>نشطون</span></span>
        </div>
        <div class="kpi-card">
          <span class="kpi-title">المشاريع النشطة</span>
          <span class="kpi-value" id="kpi-active-projects">—</span>
          <span class="kpi-trend"><i class="fa-solid fa-diagram-project"></i><span>قيد التنفيذ</span></span>
        </div>
      </div>
      <div class="dashboard-grid">
        <div class="panel">
          <h3>تقدّم المشاريع</h3>
          <div class="projects-list" id="projectsList"></div>
        </div>
        <div class="side-grid">
          <div class="panel">
            <h3>الإيرادات الشهرية</h3>
            <div class="chart-wrap">
              <canvas id="revenueChart"></canvas>
            </div>
          </div>
          <div class="panel">
            <h3>المهام القريبة</h3>
            <div class="due-list" id="dueList"></div>
          </div>
        </div>
      </div>
      <div class="panel" style="margin-top:24px">
        <h3>العملاء ومعلومات التواصل</h3>
        <table class="clients-table">
          <thead>
            <tr>
              <th>العميل</th>
              <th>الشركة</th>
              <th>البريد</th>
              <th>الهاتف</th>
              <th>روابط</th>
              <th>إدارة</th>
            </tr>
          </thead>
          <tbody id="clientsTable"></tbody>
        </table>
      </div>
      <div class="panel" style="margin-top:24px">
        <h3>آخر النشاطات</h3>
        <div class="activity-list" id="activityList"></div>
      </div>
    </div>
  </section>
  <div class="changelog-modal" id="formModal">
    <div class="changelog-overlay"></div>
    <div class="changelog-popup">
      <button type="button" class="changelog-close" id="modalClose"><i class="fa-solid fa-xmark"></i></button>
      <div class="changelog-header"><h3 id="modalTitle">إدارة البيانات</h3></div>
      <div class="changelog-body" id="modalBody"></div>
    </div>
  </div>
  <script src="../script.js"></script>
  <script>
    const defaultData={kpis:{monthRevenue:2150,totalRevenue:24350,clients:12,activeProjects:5,monthGrowth:8.4},projects:[{title:"بوت ديسكورد متجر رقمي",client:"Alkhazalih Store",progress:72,deadline:"2026-02-20",status:"نشط"},{title:"لوحة إدارة العملاء",client:"Ruhul Studios",progress:58,deadline:"2026-03-05",status:"نشط"},{title:"موقع تعريفي شخصي",client:"Self",progress:100,deadline:"2026-01-15",status:"مكتمل"},{title:"نظام دفع آلي",client:"Partner Co.",progress:35,deadline:"2026-03-22",status:"قيد البدء"}],revenueMonthly:[1200,1550,1800,1750,1900,2100,2300,2200,2000,2150,2300,2450],dueTasks:[{title:"ربط بوابة الدفع",project:"نظام دفع آلي",due:"بعد 3 أيام"},{title:"اختبارات نهائية",project:"لوحة إدارة العملاء",due:"بعد 6 أيام"},{title:"نشر نسخة تجريبية",project:"بوت ديسكورد متجر رقمي",due:"غدًا"}],clients:[{name:"Mohammad",company:"Ruhul Studios",email:"contact@alkhazalih.xyz",phone:"+962-7xxxxxx",links:[{label:"Discord",href:"https://discord.gg/9ravwb3WHM"},{label:"GitHub",href:"https://github.com/Alkhazalih"}]},{name:"Sara",company:"Partner Co.",email:"biz@partner.example",phone:"+962-7xxxxxx",links:[{label:"Email",href:"mailto:biz@partner.example"}]},{name:"Khaled",company:"Freelance",email:"khaled@example.com",phone:"+962-7xxxxxx",links:[{label:"Website",href:"https://alkhazalih.xyz"}]}],activities:[{type:"success",text:"إغلاق تذكرة دعم لعميل Ruhul Studios"},{type:"info",text:"تحديث أسعار باقات البوتات"},{type:"warn",text:"تأخير بسيط في تسليم واجهة الدفع"}]};
    let data;
    function loadData(){try{const s=localStorage.getItem("dashboardData");data=s?JSON.parse(s):JSON.parse(JSON.stringify(defaultData))}catch(e){data=JSON.parse(JSON.stringify(defaultData))}}
    function saveData(){localStorage.setItem("dashboardData",JSON.stringify(data))}
    function formatCurrency(n){return new Intl.NumberFormat("en-US",{style:"currency",currency:"JOD",maximumFractionDigits:0}).format(n)}
    function formatNumber(n){return Number(n).toLocaleString("en-US")}
    function mountKPIs(){document.getElementById("kpi-month-revenue").textContent=formatCurrency(data.kpis.monthRevenue);document.getElementById("kpi-total-revenue").textContent=formatCurrency(data.kpis.totalRevenue);document.getElementById("kpi-clients").textContent=formatNumber(data.kpis.clients);document.getElementById("kpi-active-projects").textContent=formatNumber(data.kpis.activeProjects);document.getElementById("kpi-month-trend").querySelector("span").textContent=`${formatNumber(data.kpis.monthGrowth)}%`}
    function mountProjects(){const c=document.getElementById("projectsList");c.innerHTML="";data.projects.forEach((p,i)=>{const el=document.createElement("div");el.className="project-item";el.innerHTML=`<div class="project-meta"><div class="project-title">${p.title}</div><div class="project-client">${p.client}</div><div class="progress"><span style="width:${p.progress}%"></span></div><div class="progress-meta"><span>إنجاز: ${p.progress}%</span><span>الموعد: ${p.deadline}</span></div></div><div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end"><div class="chip"><i class="fa-regular fa-clock"></i><span>${p.status}</span></div><div style="display:flex;gap:8px"><button class="chip" data-action="edit-project" data-index="${i}"><i class="fa-solid fa-pen"></i><span>تعديل</span></button><button class="chip" data-action="delete-project" data-index="${i}"><i class="fa-solid fa-trash"></i><span>حذف</span></button></div></div>`;c.appendChild(el)})}
    function mountDue(){const c=document.getElementById("dueList");c.innerHTML="";data.dueTasks.forEach((t,i)=>{const el=document.createElement("div");el.className="due-item";el.innerHTML=`<div><strong>${t.title}</strong><div class="project-client">${t.project}</div></div><div style="display:flex;gap:8px;align-items:center"><span class="chip"><i class="fa-regular fa-calendar"></i>${t.due}</span><button class="chip" data-action="edit-task" data-index="${i}"><i class="fa-solid fa-pen"></i><span>تعديل</span></button><button class="chip" data-action="delete-task" data-index="${i}"><i class="fa-solid fa-trash"></i><span>حذف</span></button></div>`;c.appendChild(el)})}
    function mountClients(){const tbody=document.getElementById("clientsTable");tbody.innerHTML="";data.clients.forEach((cl,i)=>{const tr=document.createElement("tr");const links=(cl.links||[]).map(l=>`<a class="btn-link" href="${l.href}" target="_blank" rel="noopener"><i class="fa-solid fa-link"></i>${l.label}</a>`).join("");tr.innerHTML=`<td>${cl.name}</td><td>${cl.company}</td><td>${cl.email}</td><td>${cl.phone}</td><td class="client-actions">${links}</td><td><div style="display:flex;gap:8px"><button class="chip" data-action="edit-client" data-index="${i}"><i class="fa-solid fa-pen"></i><span>تعديل</span></button><button class="chip" data-action="delete-client" data-index="${i}"><i class="fa-solid fa-trash"></i><span>حذف</span></button></div></td>`;tbody.appendChild(tr)})}
    function mountActivities(){const c=document.getElementById("activityList");data.activities.forEach(a=>{const el=document.createElement("div");el.className="activity-item";el.innerHTML=`<span class="dot ${a.type}"></span><span>${a.text}</span>`;c.appendChild(el)})}
    function drawLineChart(canvasId,values){const canvas=document.getElementById(canvasId);const ctx=canvas.getContext("2d");const w=canvas.width=canvas.offsetWidth;const h=canvas.height=220;const pad=28;const max=Math.max(...values)*1.1;ctx.clearRect(0,0,w,h);ctx.strokeStyle="rgba(255,255,255,0.1)";ctx.beginPath();ctx.moveTo(pad,pad);ctx.lineTo(pad,h-pad);ctx.lineTo(w-pad,h-pad);ctx.stroke();const step=(w-2*pad)/(values.length-1);ctx.beginPath();ctx.strokeStyle="#5865F2";ctx.lineWidth=2;values.forEach((v,i)=>{const x=pad+i*step;const y=h-pad-(v/max)*(h-2*pad);if(i===0)ctx.moveTo(x,y);else ctx.lineTo(x,y)});ctx.stroke();ctx.fillStyle="rgba(88,101,242,0.15)";ctx.beginPath();values.forEach((v,i)=>{const x=pad+i*step;const y=h-pad-(v/max)*(h-2*pad);ctx.lineTo(x,y)});ctx.lineTo(w-pad,h-pad);ctx.lineTo(pad,h-pad);ctx.closePath();ctx.fill()}
    function renderAll(){mountKPIs();mountProjects();mountDue();mountClients();mountActivities();drawLineChart("revenueChart",data.revenueMonthly)}
    function openForm(type,index){const modal=document.getElementById("formModal");const title=document.getElementById("modalTitle");const body=document.getElementById("modalBody");let html="";if(type==="project"){const p=index!=null?data.projects[index]:{title:"",client:"",progress:0,deadline:"",status:"نشط"};title.textContent=index!=null?"تعديل مشروع":"إضافة مشروع";html=`<div style="display:flex;flex-direction:column;gap:12px"><input id="f_title" class="btn" style="width:100%" value="${p.title}" placeholder="اسم المشروع"><input id="f_client" class="btn" style="width:100%" value="${p.client}" placeholder="العميل"><input id="f_progress" class="btn" style="width:100%" type="number" min="0" max="100" value="${p.progress}" placeholder="نسبة الإنجاز"><input id="f_deadline" class="btn" style="width:100%" type="date" value="${p.deadline}"><select id="f_status" class="btn" style="width:100%"><option ${p.status==="نشط"?"selected":""}>نشط</option><option ${p.status==="مكتمل"?"selected":""}>مكتمل</option><option ${p.status==="قيد البدء"?"selected":""}>قيد البدء</option></select><button class="download-btn" id="saveBtn"><i class="fa-solid fa-floppy-disk"></i> حفظ</button></div>`;body.innerHTML=html;document.getElementById("saveBtn").onclick=()=>{const np={title:document.getElementById("f_title").value,client:document.getElementById("f_client").value,progress:Number(document.getElementById("f_progress").value),deadline:document.getElementById("f_deadline").value,status:document.getElementById("f_status").value};if(index!=null){data.projects[index]=np}else{data.projects.push(np)};saveData();closeForm();renderAll()}}else if(type==="client"){const cl=index!=null?data.clients[index]:{name:"",company:"",email:"",phone:"",links:[]};title.textContent=index!=null?"تعديل عميل":"إضافة عميل";html=`<div style="display:flex;flex-direction:column;gap:12px"><input id="c_name" class="btn" style="width:100%" value="${cl.name}" placeholder="الاسم"><input id="c_company" class="btn" style="width:100%" value="${cl.company}" placeholder="الشركة"><input id="c_email" class="btn" style="width:100%" value="${cl.email}" placeholder="البريد"><input id="c_phone" class="btn" style="width:100%" value="${cl.phone}" placeholder="الهاتف"><button class="download-btn" id="saveBtn"><i class="fa-solid fa-floppy-disk"></i> حفظ</button></div>`;body.innerHTML=html;document.getElementById("saveBtn").onclick=()=>{const nc={name:document.getElementById("c_name").value,company:document.getElementById("c_company").value,email:document.getElementById("c_email").value,phone:document.getElementById("c_phone").value,links:cl.links||[]};if(index!=null){data.clients[index]=nc}else{data.clients.push(nc)};saveData();closeForm();renderAll()}}else if(type==="task"){const t=index!=null?data.dueTasks[index]:{title:"",project:"",due:""};title.textContent=index!=null?"تعديل مهمة":"إضافة مهمة";html=`<div style="display:flex;flex-direction:column;gap:12px"><input id="t_title" class="btn" style="width:100%" value="${t.title}" placeholder="عنوان المهمة"><input id="t_project" class="btn" style="width:100%" value="${t.project}" placeholder="المشروع"><input id="t_due" class="btn" style="width:100%" value="${t.due}" placeholder="الاستحقاق"><button class="download-btn" id="saveBtn"><i class="fa-solid fa-floppy-disk"></i> حفظ</button></div>`;body.innerHTML=html;document.getElementById("saveBtn").onclick=()=>{const nt={title:document.getElementById("t_title").value,project:document.getElementById("t_project").value,due:document.getElementById("t_due").value};if(index!=null){data.dueTasks[index]=nt}else{data.dueTasks.push(nt)};saveData();closeForm();renderAll()}}else if(type==="kpi"){title.textContent="تحديث المؤشرات";html=`<div style="display:flex;flex-direction:column;gap:12px"><input id="k_month" class="btn" style="width:100%" type="number" value="${data.kpis.monthRevenue}" placeholder="الإيراد الشهري"><input id="k_total" class="btn" style="width:100%" type="number" value="${data.kpis.totalRevenue}" placeholder="إجمالي الإيرادات"><input id="k_clients" class="btn" style="width:100%" type="number" value="${data.kpis.clients}" placeholder="عدد العملاء"><input id="k_active" class="btn" style="width:100%" type="number" value="${data.kpis.activeProjects}" placeholder="المشاريع النشطة"><input id="k_growth" class="btn" style="width:100%" type="number" value="${data.kpis.monthGrowth}" placeholder="نمو شهري %"><button class="download-btn" id="saveBtn"><i class="fa-solid fa-floppy-disk"></i> حفظ</button></div>`;body.innerHTML=html;document.getElementById("saveBtn").onclick=()=>{data.kpis.monthRevenue=Number(document.getElementById("k_month").value);data.kpis.totalRevenue=Number(document.getElementById("k_total").value);data.kpis.clients=Number(document.getElementById("k_clients").value);data.kpis.activeProjects=Number(document.getElementById("k_active").value);data.kpis.monthGrowth=Number(document.getElementById("k_growth").value);saveData();closeForm();renderAll()}};modal.classList.add("open")}
    function closeForm(){document.getElementById("formModal").classList.remove("open")}
    loadData();renderAll();
    window.addEventListener("resize",()=>drawLineChart("revenueChart",data.revenueMonthly));
    document.getElementById("logoutBtn").addEventListener("click",()=>{localStorage.removeItem("dashboardAuth");window.location.href="./login.html"})
    document.getElementById("modalClose").addEventListener("click",closeForm)
    document.getElementById("addProjectBtn").addEventListener("click",()=>openForm("project"))
    document.getElementById("addClientBtn").addEventListener("click",()=>openForm("client"))
    document.getElementById("updateKpiBtn").addEventListener("click",()=>openForm("kpi"))
    document.getElementById("exportBtn").addEventListener("click",()=>{const a=document.createElement("a");a.href="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(data,null,2));a.download="dashboard-data.json";a.click()})
    document.getElementById("importBtn").addEventListener("click",()=>{const inp=document.createElement("input");inp.type="file";inp.accept="application/json";inp.onchange=e=>{const file=e.target.files[0];if(!file)return;const r=new FileReader();r.onload=()=>{try{const obj=JSON.parse(r.result);data=obj;saveData();renderAll()}catch(_){}};r.readAsText(file)};inp.click()})
    document.getElementById("projectsList").addEventListener("click",e=>{const b=e.target.closest("button");if(!b)return;const i=Number(b.dataset.index);if(b.dataset.action==="edit-project"){openForm("project",i)}else if(b.dataset.action==="delete-project"){data.projects.splice(i,1);saveData();renderAll()}})
    document.getElementById("dueList").addEventListener("click",e=>{const b=e.target.closest("button");if(!b)return;const i=Number(b.dataset.index);if(b.dataset.action==="edit-task"){openForm("task",i)}else if(b.dataset.action==="delete-task"){data.dueTasks.splice(i,1);saveData();renderAll()}})
    document.getElementById("clientsTable").addEventListener("click",e=>{const b=e.target.closest("button");if(!b)return;const i=Number(b.dataset.index);if(b.dataset.action==="edit-client"){openForm("client",i)}else if(b.dataset.action==="delete-client"){data.clients.splice(i,1);saveData();renderAll()}})
  </script>
</body>
</html>
